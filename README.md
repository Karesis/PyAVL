# pyavl: ä¸€ä¸ªç”± C è¯­è¨€é©±åŠ¨çš„é«˜æ€§èƒ½ Python AVL æ ‘åº“

[![CI/CD Status](https://github.com/Karesis/PyAVL/actions/workflows/ci.yml/badge.svg)](https://github.com/Karesis/PyAVL/actions/workflows/ci.yml)
[![Coverage Status](https://img.shields.io/badge/coverage-100%25-brightgreen)](https://img.shields.io/badge/coverage-100%25-brightgreen)
[![PyPI version](https://img.shields.io/pypi/v/pyavl?color=blue&label=pypi)](https://pypi.org/project/pyavl/)
[![License](https://img.shields.io/badge/license-MIT-blue)](LICENSE)

**`pyavl`** æ˜¯ä¸€ä¸ªåŠŸèƒ½å®Œå¤‡ã€æ€§èƒ½å“è¶Šçš„å¹³è¡¡äºŒå‰æ ‘ï¼ˆAVLæ ‘ï¼‰Python åº“ã€‚å®ƒçš„æ ¸å¿ƒæ•°æ®ç»“æ„ä¸ç®—æ³•ç”±çº¯ C è¯­è¨€å®ç°ï¼Œç¡®ä¿äº†åœ¨è¿›è¡Œå¤§é‡æ’å…¥ã€åˆ é™¤å’ŒæŸ¥æ‰¾æ“ä½œæ—¶çš„é«˜æ•ˆç‡ï¼›åŒæ—¶ï¼Œå®ƒé€šè¿‡ç²¾å¿ƒè®¾è®¡çš„å°è£…å±‚ï¼Œä¸º Python ç”¨æˆ·æä¾›äº†ç®€æ´ã€æ˜“ç”¨ä¸”ç¬¦åˆè¯­è¨€ä¹ æƒ¯çš„é¢å‘å¯¹è±¡æ¥å£ã€‚

è¿™ä¸ªé¡¹ç›®è¯ç”Ÿäºä¸€æ¬¡æ•°æ®ç»“æ„è¯¾ç¨‹çš„ä½œä¸šï¼Œå¹¶è‡´åŠ›äºåœ¨æ»¡è¶³å­¦æœ¯è¦æ±‚çš„åŸºç¡€ä¸Šï¼Œæ¢ç´¢çœŸå®ä¸–ç•Œä¸­ Python ä¸ C è¯­è¨€æ··åˆç¼–ç¨‹çš„æœ€ä½³å·¥ç¨‹å®è·µã€‚

---

## ä¸»è¦ç‰¹æ€§

* **æ€§èƒ½å“è¶Š**: æ ¸å¿ƒé€»è¾‘ç”± C è¯­è¨€ç¼–å†™ï¼Œæ‰§è¡Œé€Ÿåº¦è¿œè¶…çº¯ Python å®ç°ã€‚
* **Pythonic æ¥å£**: æä¾›ä¼˜é›…çš„ `AVLTree` ç±»ï¼Œæ”¯æŒ `with` è¯­å¥è¿›è¡Œè‡ªåŠ¨èµ„æºç®¡ç†ï¼Œæ”¯æŒ `in` å…³é”®å­—è¿›è¡ŒæŸ¥æ‰¾ï¼Œå¹¶æä¾›äº† `print()` çš„ç›´è§‚æ˜¾ç¤ºã€‚
* **åŠŸèƒ½å®Œå¤‡**: å®ç°äº† AVL æ ‘æ‰€æœ‰åŸºæœ¬æ“ä½œï¼ŒåŒ…æ‹¬æ’å…¥ã€åˆ é™¤ã€æŸ¥æ‰¾å’Œè‡ªå®šä¹‰ä¸­åºéå†ã€‚
* **é«˜çº§æ“ä½œ**: æ”¯æŒä¸¤æ£µæ ‘çš„**åˆå¹¶ (merge)**ã€å°†ä¸€æ£µæ ‘**åˆ†è£‚ (split)** ä¸ºä¸¤æ£µï¼Œä¸ºå¤æ‚æ•°æ®å¤„ç†æä¾›äº†å¼ºå¤§å·¥å…·ã€‚
* **å¼ºå¤§çš„äº¤äº’å¼CLI**: è‡ªå¸¦ä¸€ä¸ªåŠŸèƒ½ä¸°å¯Œçš„å‘½ä»¤è¡Œå·¥å…·ï¼Œæ”¯æŒå¤šæ ‘ç®¡ç†ã€æ–‡ä»¶å­˜å–å’Œå®æ—¶å¯è§†åŒ–ï¼Œæ˜¯å­¦ä¹ å’Œè°ƒè¯•çš„ç»ä½³ä¼´ä¾£ã€‚
* **å¥å£®å¯é **: é…å¤‡äº†å®Œæ•´çš„æµ‹è¯•å¥—ä»¶ï¼ˆä½¿ç”¨ `pytest`ï¼‰ï¼Œä»£ç è¦†ç›–ç‡è¾¾åˆ°100%ï¼Œå¹¶é›†æˆäº†è·¨å¹³å°ï¼ˆWindows, macOS, Linuxï¼‰çš„è‡ªåŠ¨åŒ–æµ‹è¯•æµç¨‹ã€‚
* **å†…å­˜å®‰å…¨**: ç²¾å¿ƒå¤„ç†äº† C è¯­è¨€å±‚é¢çš„å†…å­˜åˆ†é…ä¸é‡Šæ”¾ï¼Œé€šè¿‡ Python çš„åƒåœ¾å›æ”¶æœºåˆ¶å’Œä¸Šä¸‹æ–‡ç®¡ç†å™¨æä¾›åŒé‡ä¿éšœã€‚

---

## å®‰è£…

æœªæ¥é¡¹ç›®å‘å¸ƒåˆ° PyPI åï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼å®‰è£…ï¼š
```bash
# ä½¿ç”¨ uv
uv pip install pyavl

# æˆ–ä½¿ç”¨ pip
pip install pyavl
```

ç›®å‰ï¼Œä½ å¯ä»¥ç›´æ¥ä»æºä»£ç è¿›è¡Œå®‰è£…ï¼š
```bash
# 1. å…‹éš†ä»“åº“
git clone [https://github.com/Karesis/PyAVL.git](https://github.com/Karesis/PyAVL.git)
cd PyAVL  # æ³¨æ„å¤§å°å†™

# 2. (æ¨è) åˆ›å»ºå¹¶æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
uv venv
source .venv/bin/activate  # åœ¨ Windows PowerShell ä¸­æ˜¯ .\.venv\Scripts\Activate.ps1

# 3. ä»¥å¯ç¼–è¾‘æ¨¡å¼å®‰è£…ï¼ˆè¿™å°†ç¼–è¯‘Cæ‰©å±•ï¼‰
uv pip install -e .
```

---

## äº¤äº’å¼æ¼”ç¤º (CLI)

`pyavl` ä¸ä»…ä»…æ˜¯ä¸€ä¸ªåº“ï¼Œæ›´æ˜¯ä¸€ä¸ªå¼€ç®±å³ç”¨çš„å­¦ä¹ å·¥å…·ã€‚æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªå¼ºå¤§çš„äº¤äº’å¼å‘½ä»¤è¡Œç•Œé¢ï¼ˆCLIï¼‰ï¼Œè®©ä½ èƒ½å¤Ÿç›´è§‚åœ°æ¢ç´¢AVLæ ‘çš„å„ç§æ“ä½œã€‚

**å¯åŠ¨æ–¹å¼ï¼š**
åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹è¿è¡Œï¼š
```bash
python run.py
```

ä½ å°†çœ‹åˆ°ä¸€ä¸ªå‹å¥½çš„äº¤äº’å¼ç¯å¢ƒï¼š
```
ğŸŒ³ğŸŒ³ğŸŒ³ğŸŒ³ğŸŒ³ğŸŒ³ğŸŒ³ğŸŒ³ğŸŒ³ğŸŒ³ğŸŒ³ğŸŒ³ğŸŒ³ğŸŒ³ğŸŒ³ğŸŒ³ğŸŒ³ğŸŒ³ğŸŒ³ğŸŒ³
      æ¬¢è¿ä½¿ç”¨äº¤äº’å¼ AVL æ ‘æ¼”ç¤ºç¨‹åº
ğŸŒ³ğŸŒ³ğŸŒ³ğŸŒ³ğŸŒ³ğŸŒ³ğŸŒ³ğŸŒ³ğŸŒ³ğŸŒ³ğŸŒ³ğŸŒ³ğŸŒ³ğŸŒ³ğŸŒ³ğŸŒ³ğŸŒ³ğŸŒ³ğŸŒ³ğŸŒ³
è¾“å…¥ 'help' æˆ– 'h' æŸ¥çœ‹æ‰€æœ‰å¯ç”¨å‘½ä»¤ã€‚
(main) > i 50 30 70 20 40 80
æˆåŠŸæ’å…¥: [50, 30, 70, 20, 40, 80]
â””â”€â”€ 50
    â”œâ”€â”€ 70
    â”‚   â””â”€â”€ 80
    â””â”€â”€ 30
        â”œâ”€â”€ 40
        â””â”€â”€ 20
```
è¿™ä¸ªå·¥å…·æ”¯æŒåˆ›å»ºå’Œç®¡ç†å¤šæ£µæ ‘ã€åˆ†è£‚ä¸åˆå¹¶ã€æ–‡ä»¶å­˜å–ç­‰æ‰€æœ‰é«˜çº§åŠŸèƒ½ï¼Œæ˜¯ç†è§£å’ŒéªŒè¯`pyavl`è¡Œä¸ºçš„æœ€ä½³æ–¹å¼ã€‚

---

## å¿«é€Ÿå¼€å§‹ (åº“ä½¿ç”¨)

åªéœ€å‡ è¡Œä»£ç ï¼Œå³å¯åœ¨ä½ çš„é¡¹ç›®ä¸­ä½¿ç”¨ `pyavl`ï¼š
```python
import pyavl

# ä½¿ç”¨ with è¯­å¥ï¼Œç¡®ä¿ä½¿ç”¨å®Œæ¯•åCå±‚å†…å­˜ä¼šè¢«è‡ªåŠ¨é‡Šæ”¾
with pyavl.AVLTree() as tree:
    # æ’å…¥ä¸€äº›æ•°æ®
    keys_to_insert = [20, 10, 30, 5, 15]
    for key in keys_to_insert:
        tree.insert(key)
    
    # ç”¨ Pythonic çš„æ–¹å¼æ£€æŸ¥æˆå‘˜
    if 15 in tree:
        print("é”®å€¼ 15 å­˜åœ¨äºæ ‘ä¸­ï¼")
        
    if 99 not in tree:
        print("é”®å€¼ 99 ä¸å­˜åœ¨äºæ ‘ä¸­ã€‚")

    # ç›´æ¥ä½¿ç”¨ print() æ‰“å°æ ‘çš„æ–‡æœ¬è¡¨ç¤º
    print("\nå½“å‰æ ‘çš„ç»“æ„ï¼š")
    print(tree)
```

---

## API ä½¿ç”¨ç¤ºä¾‹

### åŸºæœ¬æ“ä½œ
```python
import pyavl

tree = pyavl.AVLTree()
tree.insert(50)
tree.insert(30)
tree.insert(70)

assert 50 in tree
tree.delete(30)
assert not (30 in tree)

print(tree)
tree.close() # ä¸»åŠ¨é‡Šæ”¾èµ„æºæ˜¯ä¸€ä¸ªå¥½ä¹ æƒ¯
```

### é«˜çº§åŠŸèƒ½

#### è‡ªå®šä¹‰éå†
ä½ å¯ä»¥ä¼ å…¥ä¸€ä¸ª Python å‡½æ•°ï¼Œåœ¨éå†æ¯ä¸ªèŠ‚ç‚¹æ—¶æ‰§è¡Œè‡ªå®šä¹‰é€»è¾‘ã€‚
```python
node_list = []
def collect_node_data(key, height, balance_factor):
    node_list.append({"key": key, "height": height, "bf": balance_factor})

with pyavl.AVLTree([10, 20]) as tree:
    tree.in_order_traverse(collect_node_data)

# node_list is now: [{'key': 10, ...}, {'key': 20, ...}]
print(node_list) 
```

#### åˆ†è£‚ (Split) & åˆå¹¶ (Merge)
`pyavl` æ”¯æŒå¼ºå¤§çš„åˆ†è£‚ä¸åˆå¹¶æ“ä½œï¼Œä¼šæ¶ˆè€—åŸå§‹æ ‘å¹¶è¿”å›æ–°æ ‘ã€‚

```python
# --- åˆ†è£‚ ---
# ä½¿ç”¨ä¾¿åˆ©æ„é€ å™¨åˆ›å»ºæ ‘
original_tree = pyavl.AVLTree.from_keys([10, 20, 30, 40, 50])
small_tree, large_tree = original_tree.split(30) # ä»¥30ä¸ºç•Œï¼ˆ<=30, >30ï¼‰
print("å°æ ‘:"); print(small_tree)
print("å¤§æ ‘:"); print(large_tree)
small_tree.close(); large_tree.close()

# --- åˆå¹¶ ---
# å‰æ: t1 çš„æ‰€æœ‰é”® < t2 çš„æ‰€æœ‰é”®
t1 = pyavl.AVLTree.from_keys([1, 5])
t2 = pyavl.AVLTree.from_keys([10, 20])
merged_tree = pyavl.AVLTree.merge(t1, t2)
print("åˆå¹¶åçš„æ–°æ ‘:"); print(merged_tree)
merged_tree.close()
```

---

## ä¸ºå¼€å‘è€…

æ¬¢è¿ä¸º `pyavl` è´¡çŒ®ä»£ç ï¼

#### è®¾ç½®å¼€å‘ç¯å¢ƒ
```bash
# å…‹éš†ã€åˆ›å»ºå¹¶æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ...
# å®‰è£…æ‰€æœ‰ä¾èµ–ï¼ˆåŒ…æ‹¬å¼€å‘ä¾èµ–ï¼‰
uv pip install -e .[dev]
```

#### è¿è¡Œæµ‹è¯•
æœ¬é¡¹ç›®ä½¿ç”¨ `pytest` è¿›è¡Œæµ‹è¯•ã€‚
```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
pytest -v

# è¿è¡Œæµ‹è¯•å¹¶æŸ¥çœ‹ä»£ç è¦†ç›–ç‡æŠ¥å‘Š
pytest --cov=pyavl
```

---

## é¡¹ç›®è®¸å¯

æœ¬é¡¹ç›®é‡‡ç”¨ [MIT è®¸å¯è¯](LICENSE)ã€‚

## è‡´è°¢

è¿™ä¸ªé¡¹ç›®æºäºä¸€æ¬¡å®è´µçš„è¯¾ç¨‹è®¾è®¡ï¼Œå®ƒè®©æˆ‘æœ‰æœºä¼šå°†ç†è®ºçŸ¥è¯†ä»˜è¯¸äºçœŸå®çš„å·¥ç¨‹å®è·µã€‚

åœ¨æ­¤ï¼Œæˆ‘ç‰¹åˆ«æƒ³æ„Ÿè°¢æˆ‘çš„AIå¯¼å¸ˆ Geminiã€‚åœ¨è¿™æ®µå……æ»¡æŒ‘æˆ˜çš„å¼€å‘æ—…ç¨‹ä¸­ï¼Œä»é¡¹ç›®åˆæœŸçš„æ¶æ„è®¾è®¡ï¼Œåˆ°æ”»å…‹æ£˜æ‰‹çš„Cè¯­è¨€å†…å­˜å’Œè·¨å¹³å°IOéš¾é¢˜ï¼Œå†åˆ°æœ€ç»ˆAPIçš„æ‰“ç£¨å’Œæµ‹è¯•ï¼Œå®ƒæ€»èƒ½ç»™äºˆæˆ‘ç²¾å‡†çš„æŒ‡å¯¼ã€å…¨æ–°çš„æ€è·¯å’Œä¸æ‡ˆçš„é¼“åŠ±ã€‚è¿™æ®µæ·±åº¦çš„äººæœºåä½œï¼Œè®©æˆ‘å¯¹è½¯ä»¶å·¥ç¨‹çš„ç†è§£æå‡åˆ°äº†ä¸€ä¸ªå…¨æ–°çš„é«˜åº¦ã€‚